{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/tailwind_output.css' %}">
    <title>DJANGLE</title>
</head>
<body>
    <div class="container mx-auto p-6">
        <a href="{% url 'search-page' %}">
        <img src="{% static 'images/djangle.jpg' %}" alt="DJANGLE Image" class="mx-auto h-16 sm:h-20 md:h-24 lg:h-32 w-auto">
        </a>
        <form method="GET" action="" class="relative max-w-4xl mx-auto">
          <!-- Input Field -->
          <input 
              type="text" 
              name="q" 
              placeholder="Search for Django Resources..." 
              value="{{ request.GET.q|default:'' }}"
              class="w-full p-3 pl-12 pr-10 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
              id="search-input"
          />
      
          <!-- Search Icon -->
          <div class="absolute inset-y-0 left-4 flex items-center text-gray-500">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-4.35-4.35M16.65 10.35a6.3 6.3 0 11-12.6 0 6.3 6.3 0 0112.6 0z"
                />
              </svg>
          </div>
      
          <!-- Clear Icon (Initially Hidden) -->
          <div 
              class="absolute inset-y-0 right-4 flex items-center text-gray-500 cursor-pointer hidden"
              id="clear-input"
          >
              <svg 
                xmlns="http://www.w3.org/2000/svg" 
                class="h-5 w-5" 
                fill="none" 
                viewBox="0 0 24 24" 
                stroke="currentColor"
              >
                <path 
                  stroke-linecap="round" 
                  stroke-linejoin="round" 
                  stroke-width="2" 
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
          </div>
      </form>

          <!-- Tabs Section -->
          {% if request.GET.q %}
          <div class="mt-8 flex justify-center space-x-6 border-b pb-2">
            <a href="?q={{ request.GET.q }}" 
               class="text-gray-700 hover:text-blue-500  {% if not request.GET.type %}border-b-2 border-blue-500 font-semibold{% endif %}">
               All
            </a>
            <a href="?q={{ request.GET.q }}&type=question" 
               class="text-gray-700 hover:text-blue-500 {% if request.GET.type == 'question' %}border-b-2 border-blue-500 font-semibold{% endif %}">
               Question
            </a>
            <a href="?q={{ request.GET.q }}&type=documentation" 
               class="text-gray-700 hover:text-blue-500 {% if request.GET.type == 'documentation' %}border-b-2 border-blue-500 font-semibold{% endif %}">
               Documentation
            </a>
            <a href="?q={{ request.GET.q }}&type=tutorial" 
               class="text-gray-700 hover:text-blue-500 {% if request.GET.type == 'tutorial' %}border-b-2 border-blue-500 font-semibold{% endif %}">
               Tutorial
            </a>
            <a href="?q={{ request.GET.q }}&type=repository" 
               class="text-gray-700 hover:text-blue-500 {% if request.GET.type == 'repository' %}border-b-2 border-blue-500 font-semibold{% endif %}">
               Repository
            </a>
          </div>
          {% endif %}
          
          <!-- Results Section -->
          <div class="mt-8">
            {% if request.GET.q %}
              {% if results %}
                
                <ul class="space-y-4">
                  {% for result in results %}
                  <li class="p-4 border rounded-lg shadow-sm hover:shadow-md">
                    <a href="{{ result.url }}" class="text-blue-500 hover:underline text-lg">
                      {{ result.title }}
                    </a>
                    <p class="text-gray-700 mt-2">
                      {{ result.content|truncatechars:200 }}
                    </p>
                  </li>
                  {% endfor %}
                </ul>

                <!-- Pagination Links -->
                <div class="mt-8 flex justify-center">
                  {% if results.has_previous %}
                    <a href="?q={{ request.GET.q }}&page={{ results.previous_page_number }}{% if request.GET.type %}&type={{ request.GET.type }}{% endif %}" class="text-blue-500 hover:underline">Previous</a>
                  {% endif %}
                  <span class="mx-4 text-gray-700">Page {{ results.number }} of {{ results.paginator.num_pages }}</span>
                  {% if results.has_next %}
                    <a href="?q={{ request.GET.q }}&page={{ results.next_page_number }}{% if request.GET.type %}&type={{ request.GET.type }}{% endif %}" class="text-blue-500 hover:underline">Next</a>
                  {% endif %}

              {% else %}
                <p class="text-gray-600 text-center">No results found.</p>
              {% endif %}
            {% endif %}
          </div>
    </div>
    <script>
      const inputField = document.getElementById('search-input');
      const clearIcon = document.getElementById('clear-input');
  
      // Show or hide the clear icon based on input
      inputField.addEventListener('input', () => {
          if (inputField.value.trim() !== '') {
              clearIcon.classList.remove('hidden');  // Show clear icon
          } else {
              clearIcon.classList.add('hidden');    // Hide clear icon
          }
      });
  
      // Clear the input field when the clear icon is clicked
      clearIcon.addEventListener('click', () => {
          inputField.value = '';       // Clear the input field
          clearIcon.classList.add('hidden');  // Hide the clear icon
          inputField.focus();          // Focus back on the input field
      });
    </script>
</body>
</html>